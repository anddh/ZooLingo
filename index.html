<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="manifest" href="manifest.json">
    <title>Root & Roar</title>
    <style>
        body, html {
            margin: 0; padding: 0; height: 100%; width: 100%;
            font-family: 'Comic Sans MS', 'Chalkboard SE', sans-serif;
            background-color: #fffbf0; 
            transition: background-color 0.8s ease;
            overflow: hidden; display: flex; flex-direction: column;
            align-items: center; justify-content: center; -webkit-tap-highlight-color: transparent;
        }
        #app-container { width: 90%; max-width: 500px; height: 95%; display: flex; flex-direction: column; justify-content: space-between; text-align: center; position: relative; }
        #settings-trigger { position: absolute; top: 0; right: 0; font-size: 1.5rem; opacity: 0.15; padding: 10px; cursor: pointer; z-index: 10; }
        #stage { flex-grow: 1; background: white; border: 4px solid #333; border-radius: 35px; box-shadow: 12px 12px 0px rgba(0,0,0,0.1); margin-top: 40px; margin-bottom: 15px; display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        #item-img { width: 70%; height: 70%; object-fit: contain; filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.1)); animation: float 4s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0px) rotate(0deg); } 50% { transform: translateY(-15px) rotate(2deg); } }
        .wobble { animation: wobble-hor-bottom 0.6s both; }
        @keyframes wobble-hor-bottom { 0%, 100% { transform: translateX(0%); } 15% { transform: translateX(-15px) rotate(-3deg); } 30% { transform: translateX(10px) rotate(3deg); } 45% { transform: translateX(-10px) rotate(-2deg); } 60% { transform: translateX(5px) rotate(1deg); } }
        .labels h1, .labels h2 { display: block; cursor: pointer; margin: 0; padding: 5px; }
        .labels h1 { font-size: 3.5rem; color: #333; }
        .labels h2 { font-size: 2.5rem; color: #444; font-weight: 400; opacity: 0.8; }
        .wiggle-text { animation: wiggle 0.3s ease; }
        @keyframes wiggle { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(-3deg); } 75% { transform: rotate(3deg); } }
        .nav-bar { height: 100px; margin-top: 10px; }
        button#next-btn { width: 100%; height: 100%; border: 4px solid #333; border-radius: 25px; background-color: #333; color: white; font-size: 2.2rem; font-weight: bold; box-shadow: 8px 8px 0 rgba(0,0,0,0.2); cursor: pointer; }
        #start-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fffbf0; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        .splash-controls { width: 80%; max-width: 400px; display: flex; flex-direction: column; gap: 15px; margin-bottom: 30px; }
        .btn-pill { flex: 1; background: white; border: 3px solid #333; border-radius: 20px; padding: 12px; font-size: 1.1rem; font-weight: bold; box-shadow: 4px 4px 0 #333; cursor: pointer; }
        .btn-pill.active { background: #333; color: white; transform: translate(2px, 2px); box-shadow: 0px 0px 0 #333; }
        #start-btn { padding: 20px 70px; font-size: 2.2rem; background: #e76f51; color: white; border: 5px solid #333; border-radius: 30px; box-shadow: 10px 10px 0 #333; font-weight: bold; cursor: pointer; }
        .icon-overlay { position: absolute; top: 25px; right: 25px; font-size: 2.5rem; opacity: 0; transition: opacity 0.2s; pointer-events: none; }
    </style>
</head>
<body id="body">

    <div id="start-overlay">
        <h1 style="margin-bottom: 20px; font-size: 3.2rem; color: #333;">Root & Roar</h1>
        <div class="splash-controls">
            <p id="mode-label" style="margin: 0; font-weight: bold;">Modo:</p>
            <div style="display: flex; gap: 10px;">
                <button class="btn-pill active" id="mode-zoo" onclick="setMode('zoo')">ü¶Å Zoo</button>
                <button class="btn-pill" id="mode-veg" onclick="setMode('veg')">ü•ï Vegetales</button>
            </div>
            <p id="lang-label" style="margin: 10px 0 0 0; font-weight: bold;">Idioma:</p>
            <div style="display: flex; gap: 10px;">
                <button class="btn-pill active" id="lang-es" onclick="setLang('es')">üá≤üáΩ Latino</button>
                <button class="btn-pill" id="lang-fr" onclick="setLang('fr')">üá´üá∑ FR</button>
            </div>
        </div>
        <button id="start-btn" onclick="startApp()">START</button>
    </div>

    <div id="app-container">
        <div id="settings-trigger" onclick="showSettings()">‚öôÔ∏è</div>
        <div id="stage" onclick="interactCard()">
            <img id="item-img" src="" alt="Item">
            <div id="status-icon" class="icon-overlay">üó£Ô∏è</div>
        </div>
        <div class="labels">
            <h1 id="name-en" onclick="repeatWord('en')">...</h1>
            <h2 id="name-sec" onclick="repeatWord('sec')">...</h2>
        </div>
        <div class="nav-bar">
            <button id="next-btn" onclick="nextItem()">SIGUIENTE ‚ûî</button>
        </div>
    </div>

    <script>
        // UI Translations
        const uiText = {
            es: { start: "¬°VAMOS!", next: "SIGUIENTE ‚ûî", mode: "Modo:", lang: "Idioma:", zoo: "ü¶Å Zoo", veg: "ü•ï Huerta" },
            fr: { start: "C'EST PARTI !", next: "SUIVANT ‚ûî", mode: "Mode :", lang: "Langue :", zoo: "ü¶Å Zoo", veg: "ü•ï Jardin" }
        };

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').catch(err => console.log(err));
            });
        }

        const imgBase = "https://raw.githubusercontent.com/hfg-gmuend/openmoji/master/color/svg/";
        const sfxBase = "https://www.google.com/logos/fnbx/animal_sounds/";
        const colors = ['#fffbf0', '#f0fff4', '#f0f4ff', '#fff0f5', '#fdf2e9', '#e8f8f5'];

        const zooData = [
            { en: "Dog", es: "El Perro", fr: "Le Chien", id: "1F415", sfx: "dog.mp3" },
            { en: "Cat", es: "El Gato", fr: "Le Chat", id: "1F408", sfx: "cat.mp3" },
            { en: "Lion", es: "El Le√≥n", fr: "Le Lion", id: "1F981", sfx: "lion.mp3" },
            { en: "Cow", es: "La Vaca", fr: "La Vache", id: "1F404", sfx: "cow.mp3" },
            { en: "Pig", es: "El Chancho", fr: "Le Cochon", id: "1F437", sfx: "pig.mp3" },
            { en: "Sheep", es: "La Oveja", fr: "Le Mouton", id: "1F411", sfx: "sheep.mp3" },
            { en: "Duck", es: "El Pato", fr: "Le Canard", id: "1F986", sfx: "duck.mp3" },
            { en: "Elephant", es: "El Elefante", fr: "L'√âl√©phant", id: "1F418", sfx: "elephant.mp3" },
            { en: "Tiger", es: "El Tigre", fr: "Le Tigre", id: "1F405", sfx: "tiger.mp3" },
            { en: "Horse", es: "El Caballo", fr: "Le Cheval", id: "1F434", sfx: "horse.mp3" }
        ];

        const vegData = [
            { en: "Carrot", es: "La Zanahoria", fr: "La Carotte", id: "1F955" },
            { en: "Broccoli", es: "El Br√≥coli", fr: "Le Brocoli", id: "1F966" },
            { en: "Corn", es: "El Elote", fr: "Le Ma√Øs", id: "1F33D" },
            { en: "Tomato", es: "El Tomate", fr: "La Tomate", id: "1F345" },
            { en: "Potato", es: "La Papa", fr: "La Pomme de terre", id: "1F954" },
            { en: "Avocado", es: "El Aguacate", fr: "L'Avocat", id: "1F951" },
            { en: "Peas", es: "Los Ch√≠charos", fr: "Les Petits Pois", id: "1F96C" }
        ];

        let currentMode = 'zoo'; let currentLang = 'es'; let currentDeck = []; let currentItem = null;

        function setMode(mode) { 
            currentMode = mode; 
            document.getElementById('mode-zoo').className = mode === 'zoo' ? 'btn-pill active' : 'btn-pill'; 
            document.getElementById('mode-veg').className = mode === 'veg' ? 'btn-pill active' : 'btn-pill'; 
        }

        function setLang(lang) { 
            currentLang = lang; 
            document.getElementById('lang-es').className = lang === 'es' ? 'btn-pill active' : 'btn-pill'; 
            document.getElementById('lang-fr').className = lang === 'fr' ? 'btn-pill active' : 'btn-pill'; 
            updateUIText();
        }

        function updateUIText() {
            const t = uiText[currentLang];
            document.getElementById('start-btn').innerText = t.start;
            document.getElementById('next-btn').innerText = t.next;
            document.getElementById('mode-label').innerText = t.mode;
            document.getElementById('lang-label').innerText = t.lang;
            document.getElementById('mode-zoo').innerText = t.zoo;
            document.getElementById('mode-veg').innerText = t.veg;
        }

        function startApp() { document.getElementById('start-overlay').style.display = 'none'; nextItem(); }
        function showSettings() { window.speechSynthesis.cancel(); document.getElementById('start-overlay').style.display = 'flex'; }

        function nextItem() {
            window.speechSynthesis.cancel();
            const source = currentMode === 'zoo' ? zooData : vegData;
            if (currentDeck.length === 0) { currentDeck = [...source].sort(() => Math.random() - 0.5); }
            currentItem = currentDeck.pop();
            document.body.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            const stage = document.getElementById('stage');
            stage.classList.remove('wobble');
            void stage.offsetWidth; 
            stage.classList.add('wobble');
            render();
        }

        function render() {
            const img = document.getElementById('item-img');
            img.style.opacity = 0;
            setTimeout(() => {
                img.src = imgBase + currentItem.id + ".svg";
                document.getElementById('name-en').innerText = currentItem.en;
                document.getElementById('name-sec').innerText = currentItem[currentLang];
                img.onload = () => { img.style.opacity = 1; };
                speakNames();
            }, 100);
        }

        function interactCard() {
            if(!currentItem) return;
            if (currentMode === 'zoo' && currentItem.sfx) { new Audio(sfxBase + currentItem.sfx).play(); showIcon("üéµ"); } else { showIcon("ü§´"); }
        }

        function repeatWord(type) {
            const element = type === 'en' ? document.getElementById('name-en') : document.getElementById('name-sec');
            element.classList.add('wiggle-text');
            setTimeout(() => element.classList.remove('wiggle-text'), 300);
            window.speechSynthesis.cancel();
            const u = new SpeechSynthesisUtterance(type === 'en' ? currentItem.en : currentItem[currentLang]);
            u.lang = type === 'en' ? 'en-GB' : (currentLang === 'es' ? 'es-MX' : 'fr-FR');
            u.rate = 0.9;
            window.speechSynthesis.speak(u);
        }

        function showIcon(char) { const icon = document.getElementById('status-icon'); icon.innerText = char; icon.style.opacity = 1; setTimeout(() => icon.style.opacity = 0, 1000); }

        function speakNames() {
            showIcon("üó£Ô∏è");
            window.speechSynthesis.cancel();
            const uEn = new SpeechSynthesisUtterance(currentItem.en); uEn.lang = 'en-GB'; uEn.rate = 0.9;
            const uSec = new SpeechSynthesisUtterance(currentItem[currentLang]); uSec.lang = currentLang === 'es' ? 'es-MX' : 'fr-FR'; uSec.rate = 0.9;
            window.speechSynthesis.speak(uEn);
            setTimeout(() => {
                window.speechSynthesis.speak(uSec);
                document.getElementById('status-icon').style.opacity = 0;
            }, 1200);
        }
        
        // Init UI
        updateUIText();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon.png">
    <link rel="manifest" href="manifest.json">
    <title>Root & Roar</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Mochiy+Pop+One&display=swap" rel="stylesheet">

    <style>
        body, html {
            margin: 0; padding: 0; height: 100%; width: 100%;
            font-family: 'Mochiy Pop One', sans-serif;
            background-color: #fffbf0; 
            transition: background-color 0.8s ease;
            overflow: hidden; display: flex; flex-direction: column;
            align-items: center; justify-content: center; -webkit-tap-highlight-color: transparent;
        }
        #app-container { width: 90%; max-width: 500px; height: 95%; display: flex; flex-direction: column; justify-content: space-between; text-align: center; position: relative; }
        #settings-trigger { position: absolute; top: 0; right: 0; font-size: 1.5rem; opacity: 0.15; padding: 10px; cursor: pointer; z-index: 10; }
        #stage { flex-grow: 1; background: white; border: 4px solid #333; border-radius: 35px; box-shadow: 12px 12px 0px rgba(0,0,0,0.1); margin-top: 40px; margin-bottom: 15px; display: flex; align-items: center; justify-content: center; position: relative; cursor: pointer; transition: transform 0.2s; }
        #item-img { width: 75%; height: 75%; object-fit: contain; filter: drop-shadow(4px 8px 12px rgba(0,0,0,0.15)); animation: float 4s ease-in-out infinite; }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-15px); } }
        .wobble { animation: wobble-hor-bottom 0.6s both; }
        @keyframes wobble-hor-bottom { 0%, 100% { transform: translateX(0%); } 15% { transform: translateX(-15px) rotate(-3deg); } 30% { transform: translateX(10px) rotate(3deg); } }
        .labels h1 { font-size: 2.8rem; color: #333; margin: 0; cursor: pointer; letter-spacing: -1px; }
        .labels h2 { font-size: 2rem; color: #444; font-weight: 400; opacity: 0.8; margin: 5px 0 0 0; cursor: pointer; }
        .wiggle-text { animation: wiggle 0.3s ease; }
        @keyframes wiggle { 0%, 100% { transform: rotate(0deg); } 25% { transform: rotate(-3deg); } 75% { transform: rotate(3deg); } }
        .nav-bar { height: 90px; margin-top: 10px; }
        button#next-btn { 
            width: 100%; height: 100%; border: 4px solid #333; border-radius: 25px; 
            background-color: #333; color: white; font-family: 'Mochiy Pop One', sans-serif;
            font-size: 1.8rem; font-weight: bold; box-shadow: 0px 8px 0 rgba(0,0,0,0.2); cursor: pointer;
            animation: pulse-button 2.5s infinite;
        }
        button#next-btn:active { transform: scale(0.95) translateY(4px); box-shadow: 0px 2px 0 rgba(0,0,0,0.2); }
        @keyframes pulse-button { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03); } }
        #start-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fffbf0; z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; padding: 20px; box-sizing: border-box; }
        .splash-controls { width: 90%; max-width: 400px; display: flex; flex-direction: column; gap: 15px; margin-bottom: 25px; }
        .btn-pill { flex: 1; background: white; border: 3px solid #333; border-radius: 20px; padding: 12px; font-family: 'Mochiy Pop One', sans-serif; font-size: 1rem; font-weight: bold; box-shadow: 4px 4px 0 #333; cursor: pointer; }
        .btn-pill.active { background: #333; color: white; transform: translate(2px, 2px); box-shadow: 0px 0px 0 #333; }
        #start-btn { padding: 15px 60px; font-family: 'Mochiy Pop One', sans-serif; font-size: 2rem; background: #e76f51; color: white; border: 5px solid #333; border-radius: 30px; box-shadow: 10px 10px 0 #333; font-weight: bold; cursor: pointer; }
        #install-container { margin-top: 25px; display: none; }
        #install-btn { padding: 10px 20px; background: #2a9d8f; color: white; border: 3px solid #333; border-radius: 15px; font-weight: bold; box-shadow: 4px 4px 0 #333; cursor: pointer; font-family: 'Mochiy Pop One', sans-serif; }
        #ios-install-hint { display: none; margin-top: 20px; background: #fff; padding: 10px; border: 2px dashed #333; border-radius: 10px; font-size: 0.8rem; }
        .icon-overlay { position: absolute; top: 25px; right: 25px; font-size: 2.5rem; opacity: 0; transition: opacity 0.2s; pointer-events: none; }
    </style>
</head>
<body>

    <div id="start-overlay">
        <h1 style="margin-bottom: 15px; font-size: 3rem; color: #333;">Root & Roar</h1>
        <div class="splash-controls">
            <p id="mode-label" style="margin: 0; font-weight: bold;">Modo:</p>
            <div style="display: flex; gap: 10px;">
                <button class="btn-pill active" id="mode-zoo" onclick="setMode('zoo')">ü¶Å Zoo</button>
                <button class="btn-pill" id="mode-veg" onclick="setMode('veg')">ü•ï Huerta</button>
            </div>
            <p id="lang-label" style="margin: 5px 0 0 0; font-weight: bold;">Idioma:</p>
            <div style="display: flex; gap: 10px;">
                <button class="btn-pill active" id="lang-es" onclick="setLang('es')">üá≤üáΩ Latino</button>
                <button class="btn-pill" id="lang-fr" onclick="setLang('fr')">üá´üá∑ FR</button>
            </div>
        </div>
        <button id="start-btn" onclick="startApp()">START</button>
        <div id="install-container"><button id="install-btn">üì≤ Install App</button></div>
        <div id="ios-install-hint">Tap <b>Share</b> then <b>'Add to Home Screen'</b> üì≤</div>
    </div>

    <div id="app-container">
        <div id="settings-trigger" onclick="showSettings()">‚öôÔ∏è</div>
        <div id="stage" onclick="interactCard()"><img id="item-img" src="" alt=""><div id="status-icon" class="icon-overlay">üó£Ô∏è</div></div>
        <div class="labels">
            <h1 id="name-en" onclick="repeatWord('en')">...</h1>
            <h2 id="name-sec" onclick="repeatWord('sec')">...</h2>
        </div>
        <div class="nav-bar"><button id="next-btn" onclick="nextItem()">SIGUIENTE ‚ûî</button></div>
    </div>

    <script>
        const uiText = {
            es: { start: "¬°VAMOS!", next: "SIGUIENTE ‚ûî", mode: "Modo:", lang: "Idioma:", zoo: "ü¶Å Zoo", veg: "ü•ï Huerta", install: "üì≤ Instalar App" },
            fr: { start: "C'EST PARTI !", next: "SUIVANT ‚ûî", mode: "Mode :", lang: "Langue :", zoo: "ü¶Å Zoo", veg: "ü•ï Jardin", install: "üì≤ Installer l'App" }
        };

        const imgBase = "https://fonts.gstatic.com/s/e/notoemoji/latest/";
        const sfxBase = "https://www.google.com/logos/fnbx/animal_sounds/";
        const colors = ['#fffbf0', '#f0fff4', '#f0f4ff', '#fff0f5', '#fdf2e9', '#e8f8f5'];

        const zooData = [
            { en: "Dog", es: "El Perro", fr: "Le Chien", id: "1f415", sfx: "dog.mp3" },
            { en: "Cat", es: "El Gato", fr: "Le Chat", id: "1f408", sfx: "cat.mp3" },
            { en: "Lion", es: "El Le√≥n", fr: "Le Lion", id: "1f981", sfx: "lion.mp3" },
            { en: "Cow", es: "La Vaca", fr: "La Vache", id: "1f404", sfx: "cow.mp3" },
            { en: "Pig", es: "El Chancho", fr: "Le Cochon", id: "1f437", sfx: "pig.mp3" },
            { en: "Sheep", es: "La Oveja", fr: "Le Mouton", id: "1f411", sfx: "sheep.mp3" },
            { en: "Duck", es: "El Pato", fr: "Le Canard", id: "1f986", sfx: "duck.mp3" },
            { en: "Elephant", es: "El Elefante", fr: "L'√âl√©phant", id: "1f418", sfx: "elephant.mp3" },
            { en: "Tiger", es: "El Tigre", fr: "Le Tigre", id: "1f405", sfx: "tiger.mp3" },
            { en: "Horse", es: "El Caballo", fr: "Le Cheval", id: "1f434", sfx: "horse.mp3" },
            { en: "Monkey", es: "El Mono", fr: "Le Singe", id: "1f435", sfx: "ape.mp3" },
            { en: "Rooster", es: "El Gallo", fr: "Le Coq", id: "1f413", sfx: "rooster.mp3" },
            { en: "Frog", es: "La Rana", fr: "La Grenouille", id: "1f438", sfx: "frog.mp3" },
            { en: "Owl", es: "El B√∫ho", fr: "Le Hibou", id: "1f989", sfx: "owl.mp3" },
            { en: "Wolf", es: "El Lobo", fr: "Le Loup", id: "1f43a", sfx: "wolf.mp3" },
            { en: "Bee", es: "La Abeja", fr: "L'Abeille", id: "1f41d" },
            { en: "Butterfly", es: "La Mariposa", fr: "Le Papillon", id: "1f98b" },
            { en: "Bear", es: "El Oso", fr: "L'Ours", id: "1f43b" },
            { en: "Panda", es: "El Panda", fr: "Le Panda", id: "1f43c" },
            { en: "Rabbit", es: "El Conejo", fr: "Le Lapin", id: "1f430" },
            { en: "Zebra", es: "La Cebra", fr: "Le Z√®bre", id: "1f993" },
            { en: "Giraffe", es: "La Jirafa", fr: "La Girafe", id: "1f992" },
            { en: "Kangaroo", es: "El Canguro", fr: "Le Kangourou", id: "1f998" },
            { en: "Whale", es: "La Ballena", fr: "La Baleine", id: "1f433" },
            { en: "Dolphin", es: "El Delf√≠n", fr: "Le Dauphin", id: "1f42c" },
            { en: "Turtle", es: "La Tortuga", fr: "La Tortue", id: "1f422" },
            { en: "Penguin", es: "El Ping√ºino", fr: "Le Pingouin", id: "1f427" },
            { en: "Gorilla", es: "El Gorila", fr: "Le Gorille", id: "1f98d" },
            { en: "Fox", es: "El Zorro", fr: "Le Renard", id: "1f98a" },
            { en: "Mouse", es: "El Rat√≥n", fr: "La Souris", id: "1f401" },
            { en: "Camel", es: "El Camello", fr: "Le Chameau", id: "1f42b" },
            { en: "Octopus", es: "El Pulpo", fr: "Le Poulpe", id: "1f419" },
            { en: "Shark", es: "El Tibur√≥n", fr: "Le Requin", id: "1f988" },
            { en: "Crocodile", es: "El Cocodrilo", fr: "Le Crocodile", id: "1f40a" },
            { en: "Eagle", es: "El √Åguila", fr: "L'Aigle", id: "1f985" },
            { en: "Flamingo", es: "El Flamenco", fr: "Le Flamant", id: "1f9a9" },
            { en: "Deer", es: "El Venado", fr: "Le Cerf", id: "1f98c" },
            { en: "Hippopotamus", es: "El Hipop√≥tamo", fr: "L'Hippopotame", id: "1f99b" },
            { en: "Rhinoceros", es: "El Rinoceronte", fr: "Le Rhinoc√©ros", id: "1f98f" }
        ];

        const vegData = [
            { en: "Carrot", es: "La Zanahoria", fr: "La Carotte", id: "1f955" },
            { en: "Corn", es: "El Elote", fr: "Le Ma√Øs", id: "1f33d" },
            { en: "Peas", es: "Los Ch√≠charos", fr: "Les Petits Pois", id: "1fadb" },
            { en: "Broccoli", es: "El Br√≥coli", fr: "Le Brocoli", id: "1f966" },
            { en: "Tomato", es: "El Tomate", fr: "La Tomate", id: "1f345" },
            { en: "Potato", es: "La Papa", fr: "La Pomme de terre", id: "1f954" },
            { en: "Avocado", es: "El Aguacate", fr: "L'Avocat", id: "1f951" },
            { en: "Onion", es: "La Cebolla", fr: "L'Oignon", id: "1f9c5" },
            { en: "Garlic", es: "El Ajo", fr: "L'Ail", id: "1f9c4" },
            { en: "Cucumber", es: "El Pepino", fr: "Le Concombre", id: "1f952" },
            { en: "Pumpkin", es: "La Calabaza", fr: "La Citrouille", id: "1f383" },
            { en: "Mushroom", es: "El Hongo", fr: "Le Champignon", id: "1f344" },
            { en: "Pepper", es: "El Chile", fr: "Le Poivron", id: "1f336" },
            { en: "Apple", es: "La Manzana", fr: "La Pomme", id: "1f34e" },
            { en: "Banana", es: "El Pl√°tano", fr: "La Banane", id: "1f34c" },
            { en: "Orange", es: "La Naranja", fr: "L'Orange", id: "1f34a" },
            { en: "Lemon", es: "El Lim√≥n", fr: "Le Citron", id: "1f34b" },
            { en: "Grapes", es: "Las Uvas", fr: "Le Raisin", id: "1f347" },
            { en: "Watermelon", es: "La Sand√≠a", fr: "La Past√®que", id: "1f349" },
            { en: "Pineapple", es: "La Pi√±a", fr: "L'Ananas", id: "1f34d" },
            { en: "Mango", es: "El Mango", fr: "La Mangue", id: "1f96d" },
            { en: "Peach", es: "El Durazno", fr: "La P√™che", id: "1f351" },
            { en: "Cherry", es: "La Cereza", fr: "La Cerise", id: "1f352" },
            { en: "Pear", es: "La Pera", fr: "La Poire", id: "1f350" },
            { en: "Strawberry", es: "La Fresa", fr: "La Fraise", id: "1f353" },
            { en: "Blueberries", es: "La Mora", fr: "La Myrtille", id: "1fad0" },
            { en: "Kiwi", es: "El Kiwi", fr: "Le Kiwi", id: "1f95d" },
            { en: "Coconut", es: "El Coco", fr: "La Noix de Coco", id: "1f965" },
            { en: "Sweet Potato", es: "El Camote", fr: "La Patate Douce", id: "1f360" },
            { en: "Aubergine", es: "La Berenjena", fr: "L'Aubergine", id: "1f346" }, // Correct British term
            { en: "Courgette", es: "La Calabacita", fr: "La Courgette", id: "1f952" }  // Correct British term
        ];

        let currentMode = 'zoo'; let currentLang = 'es'; let currentDeck = []; let currentItem = null;

        function setMode(mode) { currentMode = mode; currentDeck = []; document.getElementById('mode-zoo').className = mode === 'zoo' ? 'btn-pill active' : 'btn-pill'; document.getElementById('mode-veg').className = mode === 'veg' ? 'btn-pill active' : 'btn-pill'; }
        function setLang(lang) { currentLang = lang; document.getElementById('lang-es').className = lang === 'es' ? 'btn-pill active' : 'btn-pill'; document.getElementById('lang-fr').className = lang === 'fr' ? 'btn-pill active' : 'btn-pill'; updateUIText(); }
        function updateUIText() { const t = uiText[currentLang]; document.getElementById('start-btn').innerText = t.start; document.getElementById('next-btn').innerText = t.next; document.getElementById('mode-label').innerText = t.mode; document.getElementById('lang-label').innerText = t.lang; document.getElementById('mode-zoo').innerText = t.zoo; document.getElementById('mode-veg').innerText = t.veg; document.getElementById('install-btn').innerText = t.install; }
        function startApp() { document.getElementById('start-overlay').style.display = 'none'; nextItem(); }
        function showSettings() { window.speechSynthesis.cancel(); document.getElementById('start-overlay').style.display = 'flex'; }
        function nextItem() { window.speechSynthesis.cancel(); const source = currentMode === 'zoo' ? zooData : vegData; if (currentDeck.length === 0) { currentDeck = [...source].sort(() => Math.random() - 0.5); } currentItem = currentDeck.pop(); document.body.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)]; const stage = document.getElementById('stage'); stage.classList.remove('wobble'); void stage.offsetWidth; stage.classList.add('wobble'); render(); }
        function render() { const img = document.getElementById('item-img'); img.style.opacity = 0; setTimeout(() => { img.src = imgBase + currentItem.id + "/512.png"; document.getElementById('name-en').innerText = currentItem.en; document.getElementById('name-sec').innerText = currentItem[currentLang]; img.onload = () => { img.style.opacity = 1; }; speakNames(); }, 100); }
        function interactCard() { if(!currentItem) return; if (currentMode === 'zoo' && currentItem.sfx) { new Audio(sfxBase + currentItem.sfx).play(); showIcon("üéµ"); } else { showIcon("ü§´"); } }
        function repeatWord(type) { const el = type === 'en' ? document.getElementById('name-en') : document.getElementById('name-sec'); el.classList.add('wiggle-text'); setTimeout(() => el.classList.remove('wiggle-text'), 300); window.speechSynthesis.cancel(); const u = new SpeechSynthesisUtterance(type === 'en' ? currentItem.en : currentItem[currentLang]); u.lang = type === 'en' ? 'en-GB' : (currentLang === 'es' ? 'es-MX' : 'fr-FR'); u.rate = 0.9; window.speechSynthesis.speak(u); }
        function showIcon(char) { const icon = document.getElementById('status-icon'); icon.innerText = char; icon.style.opacity = 1; setTimeout(() => icon.style.opacity = 0, 1000); }
        function speakNames() { showIcon("üó£Ô∏è"); window.speechSynthesis.cancel(); const uEn = new SpeechSynthesisUtterance(currentItem.en); uEn.lang = 'en-GB'; uEn.rate = 0.9; const uSec = new SpeechSynthesisUtterance(currentItem[currentLang]); uSec.lang = currentLang === 'es' ? 'es-MX' : 'fr-FR'; uSec.rate = 0.9; window.speechSynthesis.speak(uEn); setTimeout(() => { window.speechSynthesis.speak(uSec); document.getElementById('status-icon').style.opacity = 0; }, 1200); }

        let deferredPrompt; window.addEventListener('beforeinstallprompt', (e) => { e.preventDefault(); deferredPrompt = e; document.getElementById('install-container').style.display = 'block'; });
        document.getElementById('install-btn').addEventListener('click', async () => { if (deferredPrompt) { deferredPrompt.prompt(); const { outcome } = await deferredPrompt.userChoice; if (outcome === 'accepted') document.getElementById('install-container').style.display = 'none'; deferredPrompt = null; } });
        const isIos = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream; if (isIos && !window.matchMedia('(display-mode: standalone)').matches) document.getElementById('ios-install-hint').style.display = 'block';
        if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js').catch(() => {});
        updateUIText();
    </script>
</body>
</html>
